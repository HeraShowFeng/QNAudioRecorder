!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t||self).QNAudioRecorder={})}(this,function(t){var e,i=/*#__PURE__*/function(){function t(t){this.audioContext=t,this.connectingToMic=!1,this.mic=null}var e=t.prototype;return e.getLoudness=function(){var t=this;if(this.mic||this.connectingToMic||(this.connectingToMic=!0,navigator.mediaDevices.getUserMedia({audio:!0}).then(function(e){t.audioStream=e,t.mic=t.audioContext.createMediaStreamSource(e),t.analyser=t.audioContext.createAnalyser(),t.mic.connect(t.analyser),t.micDataArray=new Float32Array(t.analyser.fftSize)}).catch(function(t){console.warn(t)})),this.mic&&this.audioStream&&this.audioStream.active){this.analyser.getFloatTimeDomainData(this.micDataArray);for(var e=0,i=0;i<this.micDataArray.length;i++)e+=Math.pow(this.micDataArray[i],2);var a=Math.sqrt(e/this.micDataArray.length);return this._lastValue&&(a=Math.max(a,.6*this._lastValue)),this._lastValue=a,a*=1.63,a=Math.sqrt(a),a=Math.round(100*a),(a=Math.min(a,100))/100}return 0},e.release=function(){this.connectingToMic=!1,this.mic&&(this.mic.disconnect(),this.mic=null),this.audioStream&&(this.audioStream.getTracks().forEach(function(t){return t.stop()}),this.audioStream=void 0),this.analyser&&(this.analyser.disconnect(),this.analyser=void 0)},t}(),a=new(window.AudioContext||window.webkitAudioContext)({latencyHint:"interactive"}),n=new i(a);t.start=function(t){try{return clearInterval(e),a.resume(),e=setInterval(function(){t(n.getLoudness())},100),Promise.resolve()}catch(t){return Promise.reject(t)}},t.stop=function(){clearInterval(e),n.release()}});
//# sourceMappingURL=bundle.js.map
